From 6ddb9bd07101ace39dba8a631fd853a0a92c5af9 Mon Sep 17 00:00:00 2001
From: Josh Moore <josh@openmicroscopy.org>
Date: Fri, 10 Mar 2023 16:13:34 +0100
Subject: [PATCH] Don't use relative fixture path

see: #1312
see: #1347
see: #1348
---
 zarr/tests/test_attrs.py | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

diff --git a/zarr/tests/test_attrs.py b/zarr/tests/test_attrs.py
index a329f463f..d741c1783 100644
--- a/zarr/tests/test_attrs.py
+++ b/zarr/tests/test_attrs.py
@@ -53,17 +53,18 @@ def test_storage(self, zarr_version):
     def test_utf8_encoding(self, zarr_version):
 
         project_root = pathlib.Path(zarr.__file__).resolve().parent.parent
-        fixdir = project_root / "fixture" / "utf8attrs"
-        if not fixdir.exists():  # pragma: no cover
+        fixdir = project_root / "fixture"
+        testdir = fixdir / "utf8attrs"
+        if not testdir.exists():  # pragma: no cover
             # store the data - should be one-time operation
-            fixdir.mkdir()
-            with (fixdir / ".zattrs").open("w", encoding="utf-8") as f:
+            testdir.mkdir()
+            with (testdir / ".zattrs").open("w", encoding="utf-8") as f:
                 f.write('{"foo": "た"}')
-            with (fixdir / ".zgroup").open("w", encoding="utf-8") as f:
+            with (testdir / ".zgroup").open("w", encoding="utf-8") as f:
                 f.write("""{\n    "zarr_format": 2\n}""")
 
         # fixture data
-        fixture = group(store=DirectoryStore('fixture'))
+        fixture = group(store=DirectoryStore(str(fixdir)))
         assert fixture['utf8attrs'].attrs.asdict() == dict(foo='た')
 
     def test_get_set_del_contains(self, zarr_version):
